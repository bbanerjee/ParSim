<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.21.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Particle data in VTK XML - Parresia Simulations</title>
<meta name="description" content="Outputting simulation data in C++">


  <meta name="author" content="Biswajit Banerjee">
  
  <meta property="article:author" content="Biswajit Banerjee">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Parresia Simulations">
<meta property="og:title" content="Particle data in VTK XML">
<meta property="og:url" content="https://bbanerjee.github.io/ParSim/c++/xml/vtk/vtk-particle-output/">


  <meta property="og:description" content="Outputting simulation data in C++">







  <meta property="article:published_time" content="2017-02-18T22:30:00+13:00">





  

  


<link rel="canonical" href="https://bbanerjee.github.io/ParSim/c++/xml/vtk/vtk-particle-output/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Biswajit Banerjee",
      "url": "https://bbanerjee.github.io/ParSim/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/ParSim/feed.xml" type="application/atom+xml" rel="alternate" title="Parresia Simulations Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/ParSim/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<link rel="stylesheet" href="https://bbanerjee.github.io/ParSim/assets/css/parresia.css">

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <script type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_HTMLorMML">
  </script>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/ParSim/"><img src="/ParSim/assets/img/ParresiaLogoSep2017_plain.png" alt=""></a>
        
        <a class="site-title" href="/ParSim/">
          Parresia Simulations
          <span class="site-subtitle">Parallel particle and finite element simulation</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/ParSim/docs/articles/">Blog articles</a>
            </li><li class="masthead__menu-item">
              <a href="/ParSim/docs/parsim/">ParSim software</a>
            </li><li class="masthead__menu-item">
              <a href="/ParSim/docs/material-data/">Material data</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Biswajit Banerjee</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>PhD Mechanical Engineering</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Auckland, NZ</span>
        </li>
      

      
        
          
            <li><a href="mailto:b.banerjee.nz@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Particle data in VTK XML">
    <meta itemprop="description" content="In my previous post on writing VTK output files I described how mesh data can be output in VTK XML format. In this article I will talk about how I output particle data from my simulations.">
    <meta itemprop="datePublished" content="2017-02-18T22:30:00+13:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Particle data in VTK XML
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          11 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> Contents</h4></header>
              <ul class="toc__menu">
  <li><a href="#particle-data">Particle data</a></li>
  <li><a href="#writing-the-particle-data">Writing the particle data</a></li>
  <li><a href="#displaying-the-output">Displaying the output</a></li>
</ul>

            </nav>
          </aside>
        
        <p>In my previous post on <a href="http://www.parresianz.com/c++/xml/vtk/vtk-output/">writing VTK output files</a> I described how mesh data can be output in VTK XML format. In this article I will talk about how I output particle data from my simulations.
<!--more--></p>

<p>These simulations use a number of techniques depending on the requirements. I use the MPM
(Material Point Method) and RBD (Rigid body dynamics) with the occasional 
DEM (Discrete/Distict element method) and Peridynamics simulation.  When I am
running RBD or DEM simulations, the particles may have not spherical shapes and the shape
and orientation information have to be encoded into the output data in addition to other
physical state variables.</p>

<p class="notice">Note: The visualization of non-spherical particles in Visit/Paraview requires the
implementation of a plugin that can perform the appropriate transformation.  Alternatively,
we can convert each particle into a surface mesh before writing the output. We will not
discuss these issues at this stage.  However, in future posts we will show how these plots
can be generated using Javascript.</p>

<h5 id="particle-data">Particle data</h5>

<p>We will assume that the particles are ellipsoids.  The particle data that we will output in
this example are:</p>
<ul>
  <li>The particle ID</li>
  <li>The particle radii in the three principal axis directions</li>
  <li>The three principal axis orientations</li>
  <li>The particle position</li>
  <li>The particle velocity</li>
</ul>

<h5 id="writing-the-particle-data">Writing the particle data</h5>
<p>To write the particles data to the disk, we follow the same approach as we did
for the grid/mesh data in the previous post.  The <code class="language-plaintext highlighter-rouge">writeParticles</code> function
has the form</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="kt">void</span>
<span class="n">OutputVTK</span><span class="o">::</span><span class="n">writeParticles</span><span class="p">(</span><span class="kt">double</span> <span class="n">time</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">ParticlePArray</span><span class="o">*</span> <span class="n">particles</span><span class="p">,</span>
                          <span class="n">std</span><span class="o">::</span><span class="n">ostringstream</span><span class="o">&amp;</span> <span class="n">fileName</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// Create a writer</span>
  <span class="k">auto</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">vtkXMLUnstructuredGridWriterP</span><span class="o">::</span><span class="n">New</span><span class="p">();</span>
  <span class="c1">// Get the filename with extension</span>
  <span class="n">fileName</span> <span class="o">&lt;&lt;</span> <span class="s">"."</span> <span class="o">&lt;&lt;</span> <span class="n">writer</span><span class="o">-&gt;</span><span class="n">GetDefaultFileExtension</span><span class="p">();</span>
  <span class="n">writer</span><span class="o">-&gt;</span><span class="n">SetFileName</span><span class="p">((</span><span class="n">fileName</span><span class="p">.</span><span class="n">str</span><span class="p">()).</span><span class="n">c_str</span><span class="p">());</span>
  <span class="c1">// Create a pointer to a VTK Unstructured Grid data set</span>
  <span class="k">auto</span> <span class="n">dataSet</span> <span class="o">=</span> <span class="n">vtkUnstructuredGridP</span><span class="o">::</span><span class="n">New</span><span class="p">();</span>
  <span class="c1">// Set up pointer to point data</span>
  <span class="k">auto</span> <span class="n">pts</span> <span class="o">=</span> <span class="n">vtkPointsP</span><span class="o">::</span><span class="n">New</span><span class="p">();</span>
  <span class="c1">// Count the total number of points</span>
  <span class="kt">int</span> <span class="n">num_pts</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">particles</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">());</span>
  <span class="n">pts</span><span class="o">-&gt;</span><span class="n">SetNumberOfPoints</span><span class="p">(</span><span class="n">num_pts</span><span class="p">);</span>
  <span class="c1">// Add the time</span>
  <span class="n">addTimeToVTKDataSet</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">dataSet</span><span class="p">);</span>
  <span class="c1">// Add the particle data to the unstructured grid</span>
  <span class="n">addParticlesToVTKDataSet</span><span class="p">(</span><span class="n">particles</span><span class="p">,</span> <span class="n">pts</span><span class="p">,</span> <span class="n">dataSet</span><span class="p">);</span>
  <span class="c1">// Set the points</span>
  <span class="n">dataSet</span><span class="o">-&gt;</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">pts</span><span class="p">);</span>
  <span class="c1">// Remove unused memory</span>
  <span class="n">dataSet</span><span class="o">-&gt;</span><span class="n">Squeeze</span><span class="p">();</span>
  <span class="c1">// Write the data</span>
  <span class="n">writer</span><span class="o">-&gt;</span><span class="n">SetInput</span><span class="p">(</span><span class="n">dataSet</span><span class="p">);</span>
  <span class="n">writer</span><span class="o">-&gt;</span><span class="n">SetDataModeToBinary</span><span class="p">();</span>
  <span class="n">writer</span><span class="o">-&gt;</span><span class="n">Write</span><span class="p">();</span>
<span class="p">}</span></code></pre></figure>

<p>We have already seen the <code class="language-plaintext highlighter-rouge">addTimeToVTKDataSet</code> method in the previous post.
The main difference in this case is the new <code class="language-plaintext highlighter-rouge">addParticlesToVTKDataSet</code> method:</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="kt">void</span>
<span class="n">OutputVTK</span><span class="o">::</span><span class="n">addParticlesToVTKDataSet</span><span class="p">(</span><span class="k">const</span> <span class="n">ParticlePArray</span><span class="o">*</span> <span class="n">particles</span><span class="p">,</span>
                                    <span class="n">vtkPointsP</span><span class="o">&amp;</span> <span class="n">pts</span><span class="p">,</span>
                                    <span class="n">vtkUnstructuredGridP</span><span class="o">&amp;</span> <span class="n">dataSet</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// Set up pointers for material property data</span>
  <span class="k">auto</span> <span class="n">ID</span> <span class="o">=</span> <span class="n">vtkDoubleArrayP</span><span class="o">::</span><span class="n">New</span><span class="p">();</span>
  <span class="n">ID</span><span class="o">-&gt;</span><span class="n">SetNumberOfComponents</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="n">ID</span><span class="o">-&gt;</span><span class="n">SetNumberOfTuples</span><span class="p">(</span><span class="n">pts</span><span class="o">-&gt;</span><span class="n">GetNumberOfPoints</span><span class="p">());</span>
  <span class="n">ID</span><span class="o">-&gt;</span><span class="n">SetName</span><span class="p">(</span><span class="s">"ID"</span><span class="p">);</span>

  <span class="k">auto</span> <span class="n">radii</span> <span class="o">=</span> <span class="n">vtkDoubleArrayP</span><span class="o">::</span><span class="n">New</span><span class="p">();</span>
  <span class="n">radii</span><span class="o">-&gt;</span><span class="n">SetNumberOfComponents</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
  <span class="n">radii</span><span class="o">-&gt;</span><span class="n">SetNumberOfTuples</span><span class="p">(</span><span class="n">pts</span><span class="o">-&gt;</span><span class="n">GetNumberOfPoints</span><span class="p">());</span>
  <span class="n">radii</span><span class="o">-&gt;</span><span class="n">SetName</span><span class="p">(</span><span class="s">"Radius"</span><span class="p">);</span>

  <span class="k">auto</span> <span class="n">axis_a</span> <span class="o">=</span> <span class="n">vtkDoubleArrayP</span><span class="o">::</span><span class="n">New</span><span class="p">();</span>
  <span class="n">axis_a</span><span class="o">-&gt;</span><span class="n">SetNumberOfComponents</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
  <span class="n">axis_a</span><span class="o">-&gt;</span><span class="n">SetNumberOfTuples</span><span class="p">(</span><span class="n">pts</span><span class="o">-&gt;</span><span class="n">GetNumberOfPoints</span><span class="p">());</span>
  <span class="n">axis_a</span><span class="o">-&gt;</span><span class="n">SetName</span><span class="p">(</span><span class="s">"Axis a"</span><span class="p">);</span>

  <span class="k">auto</span> <span class="n">axis_b</span> <span class="o">=</span> <span class="n">vtkDoubleArrayP</span><span class="o">::</span><span class="n">New</span><span class="p">();</span>
  <span class="n">vtkDoubleArrayP</span> <span class="n">axis_b</span> <span class="o">=</span> <span class="n">vtkDoubleArrayP</span><span class="o">::</span><span class="n">New</span><span class="p">();</span>
  <span class="n">axis_b</span><span class="o">-&gt;</span><span class="n">SetNumberOfComponents</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
  <span class="n">axis_b</span><span class="o">-&gt;</span><span class="n">SetNumberOfTuples</span><span class="p">(</span><span class="n">pts</span><span class="o">-&gt;</span><span class="n">GetNumberOfPoints</span><span class="p">());</span>
  <span class="n">axis_b</span><span class="o">-&gt;</span><span class="n">SetName</span><span class="p">(</span><span class="s">"Axis b"</span><span class="p">);</span>

  <span class="k">auto</span> <span class="n">axis_c</span> <span class="o">=</span> <span class="n">vtkDoubleArrayP</span><span class="o">::</span><span class="n">New</span><span class="p">();</span>
  <span class="n">axis_c</span><span class="o">-&gt;</span><span class="n">SetNumberOfComponents</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
  <span class="n">axis_c</span><span class="o">-&gt;</span><span class="n">SetNumberOfTuples</span><span class="p">(</span><span class="n">pts</span><span class="o">-&gt;</span><span class="n">GetNumberOfPoints</span><span class="p">());</span>
  <span class="n">axis_c</span><span class="o">-&gt;</span><span class="n">SetName</span><span class="p">(</span><span class="s">"Axis c"</span><span class="p">);</span>

  <span class="k">auto</span> <span class="n">position</span> <span class="o">=</span> <span class="n">vtkDoubleArrayP</span><span class="o">::</span><span class="n">New</span><span class="p">();</span>
  <span class="n">position</span><span class="o">-&gt;</span><span class="n">SetNumberOfComponents</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
  <span class="n">position</span><span class="o">-&gt;</span><span class="n">SetNumberOfTuples</span><span class="p">(</span><span class="n">pts</span><span class="o">-&gt;</span><span class="n">GetNumberOfPoints</span><span class="p">());</span>
  <span class="n">position</span><span class="o">-&gt;</span><span class="n">SetName</span><span class="p">(</span><span class="s">"Position"</span><span class="p">);</span>

  <span class="k">auto</span> <span class="n">velocity</span> <span class="o">=</span> <span class="n">vtkDoubleArrayP</span><span class="o">::</span><span class="n">New</span><span class="p">();</span>
  <span class="n">velocity</span><span class="o">-&gt;</span><span class="n">SetNumberOfComponents</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
  <span class="n">velocity</span><span class="o">-&gt;</span><span class="n">SetNumberOfTuples</span><span class="p">(</span><span class="n">pts</span><span class="o">-&gt;</span><span class="n">GetNumberOfPoints</span><span class="p">());</span>
  <span class="n">velocity</span><span class="o">-&gt;</span><span class="n">SetName</span><span class="p">(</span><span class="s">"Velocity"</span><span class="p">);</span>

  <span class="c1">// Loop through particles</span>
  <span class="n">Vec</span> <span class="n">vObj</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">vec</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
  <span class="k">for</span> <span class="p">(</span><span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">particle</span> <span class="o">:</span> <span class="o">*</span><span class="n">particles</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// Position</span>
    <span class="n">vObj</span> <span class="o">=</span> <span class="n">particle</span><span class="o">-&gt;</span><span class="n">getCurrPos</span><span class="p">();</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vObj</span><span class="p">.</span><span class="n">getX</span><span class="p">();</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vObj</span><span class="p">.</span><span class="n">getY</span><span class="p">();</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vObj</span><span class="p">.</span><span class="n">getZ</span><span class="p">();</span>
    <span class="n">pts</span><span class="o">-&gt;</span><span class="n">SetPoint</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">vec</span><span class="p">);</span>

    <span class="c1">// ID</span>
    <span class="n">ID</span><span class="o">-&gt;</span><span class="n">InsertValue</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">particle</span><span class="o">-&gt;</span><span class="n">getId</span><span class="p">());</span>

    <span class="c1">// Ellipsoid radii</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">particle</span><span class="o">-&gt;</span><span class="n">getA</span><span class="p">();</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">particle</span><span class="o">-&gt;</span><span class="n">getB</span><span class="p">();</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">particle</span><span class="o">-&gt;</span><span class="n">getC</span><span class="p">();</span>
    <span class="n">radii</span><span class="o">-&gt;</span><span class="n">InsertTuple</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">vec</span><span class="p">);</span>

    <span class="c1">// Current direction A</span>
    <span class="n">vObj</span> <span class="o">=</span> <span class="n">particle</span><span class="o">-&gt;</span><span class="n">getCurrDirecA</span><span class="p">();</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vObj</span><span class="p">.</span><span class="n">getX</span><span class="p">();</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vObj</span><span class="p">.</span><span class="n">getY</span><span class="p">();</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vObj</span><span class="p">.</span><span class="n">getZ</span><span class="p">();</span>
    <span class="n">axis_a</span><span class="o">-&gt;</span><span class="n">InsertTuple</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">vec</span><span class="p">);</span>

    <span class="c1">// Current direction B</span>
    <span class="n">vObj</span> <span class="o">=</span> <span class="n">particle</span><span class="o">-&gt;</span><span class="n">getCurrDirecB</span><span class="p">();</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vObj</span><span class="p">.</span><span class="n">getX</span><span class="p">();</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vObj</span><span class="p">.</span><span class="n">getY</span><span class="p">();</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vObj</span><span class="p">.</span><span class="n">getZ</span><span class="p">();</span>
    <span class="n">axis_b</span><span class="o">-&gt;</span><span class="n">InsertTuple</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">vec</span><span class="p">);</span>

    <span class="c1">// Current direction C</span>
    <span class="n">vObj</span> <span class="o">=</span> <span class="n">particle</span><span class="o">-&gt;</span><span class="n">getCurrDirecC</span><span class="p">();</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vObj</span><span class="p">.</span><span class="n">getX</span><span class="p">();</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vObj</span><span class="p">.</span><span class="n">getY</span><span class="p">();</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vObj</span><span class="p">.</span><span class="n">getZ</span><span class="p">();</span>
    <span class="n">axis_c</span><span class="o">-&gt;</span><span class="n">InsertTuple</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">vec</span><span class="p">);</span>

    <span class="c1">// Velocity</span>
    <span class="n">vObj</span> <span class="o">=</span> <span class="n">particle</span><span class="o">-&gt;</span><span class="n">getCurrVeloc</span><span class="p">();</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vObj</span><span class="p">.</span><span class="n">getX</span><span class="p">();</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vObj</span><span class="p">.</span><span class="n">getY</span><span class="p">();</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vObj</span><span class="p">.</span><span class="n">getZ</span><span class="p">();</span>
    <span class="n">velocity</span><span class="o">-&gt;</span><span class="n">InsertTuple</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">vec</span><span class="p">);</span>
    
    <span class="o">++</span><span class="n">id</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Add points to data set</span>
  <span class="n">dataSet</span><span class="o">-&gt;</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">AddArray</span><span class="p">(</span><span class="n">ID</span><span class="p">);</span>
  <span class="n">dataSet</span><span class="o">-&gt;</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">AddArray</span><span class="p">(</span><span class="n">radii</span><span class="p">);</span>
  <span class="n">dataSet</span><span class="o">-&gt;</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">AddArray</span><span class="p">(</span><span class="n">axis_a</span><span class="p">);</span>
  <span class="n">dataSet</span><span class="o">-&gt;</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">AddArray</span><span class="p">(</span><span class="n">axis_b</span><span class="p">);</span>
  <span class="n">dataSet</span><span class="o">-&gt;</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">AddArray</span><span class="p">(</span><span class="n">axis_c</span><span class="p">);</span>
  <span class="n">dataSet</span><span class="o">-&gt;</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">AddArray</span><span class="p">(</span><span class="n">velocity</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>You can see a working example of this approach in the <a href="https://github.com/bbanerjee/ParSim/blob/master/Matiti/src/InputOutput/OutputVTK.cc">Matiti code</a>.</p>

<h5 id="displaying-the-output">Displaying the output</h5>
<p>The VTK XML file output to disk using this approach can be visualized in Visit or ParaView.  Notice that we are not able to  use the particle geometry and orientation information in either of these tools without extra work.  The plot below shows the output of a rigid body dynamics simulation in the presence of Coriolis forces.</p>

<p><img src="/ParSim/assets/blogimg/CentrifugeRigidParticlesWithWallBothMat_060006.jpg" alt="Plot produced by Visit" class="img-responsive" margin="0 auto" display="block" height="450px" border="3px" /></p>

<h4 id="remarks">Remarks</h4>
<p>Now that the basic input/output issues have been addressed, we will be able to
explore possible designs of an integrated user interface to automate the generation
of input files and perform simple visualizations of the results.  Future blog posts
will discuss our exploration of Javascript frameworks and libraries that can potentially
aid this process.</p>


        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/ParSim/categories/#c" class="page__taxonomy-item" rel="tag">C++</a><span class="sep">, </span>
    
      
      
      <a href="/ParSim/categories/#vtk" class="page__taxonomy-item" rel="tag">VTK</a><span class="sep">, </span>
    
      
      
      <a href="/ParSim/categories/#xml" class="page__taxonomy-item" rel="tag">XML</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2017-02-18T22:30:00+13:00">February 18, 2017</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Particle+data+in+VTK+XML%20https%3A%2F%2Fbbanerjee.github.io%2FParSim%2Fc%2B%2B%2Fxml%2Fvtk%2Fvtk-particle-output%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fbbanerjee.github.io%2FParSim%2Fc%2B%2B%2Fxml%2Fvtk%2Fvtk-particle-output%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fbbanerjee.github.io%2FParSim%2Fc%2B%2B%2Fxml%2Fvtk%2Fvtk-particle-output%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/ParSim/c++/xml/vtk/vtk-output/" class="pagination--pager" title="Writing VTK XML files in C++
">Previous</a>
    
    
      <a href="/ParSim/javascript/typescript/vue/vuex/xml/reading-vtk-particles/" class="pagination--pager" title="Reading VTK particles in Javascript
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ParSim/fem/meshing/gmsh/gmsh-meshing-for-code-aster/" rel="permalink">Meshes with different element topologies in gmsh (for Code-Aster)
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          39 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">We have been translating a few Code-Aster verification test manuals into English.
The process is not just a straightforward translation of the text in the Fr...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ParSim/fem/meshing/gmsh/quadrlateral-meshing-with-gmsh/" rel="permalink">Creating quadrilateral surface meshes with gmsh
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          21 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">The Code-Aster cooling tower modal analysis validation test
FORMA11c comes with a quadrilateral mesh provided by Code-Aster.
Tips on quadrilateral meshing wi...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ParSim/fem/cracks/python/salome-meca/code-aster/inspecting-and-manipulating-meshes/" rel="permalink">Inspecting and manipulating meshes in Salome-Meca for Code-Aster
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          30 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">In this article, I will discuss how elements can be selected from deep inside a 3D mesh
in the Salome-Meca environment and manipulated with Python scripts.

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ParSim/vaango/compiling-vaango-on-a-cray/" rel="permalink">Compiling and running the MPM code Vaango on a Cray
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          16 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Introduction

One of the reasons I switched to cmake for my builds was the need to compile my
Vaango code on a BlueGene/Q system.  The code was previously co...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
    

    <li><a href="/ParSim/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Biswajit Banerjee. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/ParSim/assets/js/main.min.js"></script>










  </body>
</html>
