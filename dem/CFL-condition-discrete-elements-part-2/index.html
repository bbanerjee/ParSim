<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.21.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>The CFL condition for explicit discrete element methods:2 - Parresia Simulations</title>
<meta name="description" content="Part 2: The von Neumann version of the CFL condition">


  <meta name="author" content="Biswajit Banerjee">
  
  <meta property="article:author" content="Biswajit Banerjee">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Parresia Simulations">
<meta property="og:title" content="The CFL condition for explicit discrete element methods:2">
<meta property="og:url" content="https://bbanerjee.github.io/ParSim/dem/CFL-condition-discrete-elements-part-2/">


  <meta property="og:description" content="Part 2: The von Neumann version of the CFL condition">







  <meta property="article:published_time" content="2017-04-14T22:30:00+12:00">





  

  


<link rel="canonical" href="https://bbanerjee.github.io/ParSim/dem/CFL-condition-discrete-elements-part-2/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Biswajit Banerjee",
      "url": "https://bbanerjee.github.io/ParSim/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/ParSim/feed.xml" type="application/atom+xml" rel="alternate" title="Parresia Simulations Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/ParSim/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<link rel="stylesheet" href="https://bbanerjee.github.io/ParSim/assets/css/parresia.css">

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <script type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_HTMLorMML">
  </script>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/ParSim/"><img src="/ParSim/assets/img/ParresiaLogoSep2017_plain.png" alt=""></a>
        
        <a class="site-title" href="/ParSim/">
          Parresia Simulations
          <span class="site-subtitle">Parallel particle and finite element simulation</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/ParSim/docs/articles/">Blog articles</a>
            </li><li class="masthead__menu-item">
              <a href="/ParSim/docs/parsim/">ParSim software</a>
            </li><li class="masthead__menu-item">
              <a href="/ParSim/docs/material-data/">Material data</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Biswajit Banerjee</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>PhD Mechanical Engineering</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Auckland, NZ</span>
        </li>
      

      
        
          
            <li><a href="mailto:b.banerjee.nz@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="The CFL condition for explicit discrete element methods:2">
    <meta itemprop="description" content="IntroductionIn the first part of this article,we looked at the one-dimensional linear second-order wave equation">
    <meta itemprop="datePublished" content="2017-04-14T22:30:00+12:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">The CFL condition for explicit discrete element methods:2
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          15 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> Contents</h4></header>
              <ul class="toc__menu">
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#the-von-neumann-approach-to-stability-analysis">The von Neumann approach to stability analysis</a></li>
  <li><a href="#remarks">Remarks</a></li>
</ul>

            </nav>
          </aside>
        
        <link rel="stylesheet" type="text/css" href="/ParSim/assets/js/animateCFL.css" />

<h4 id="introduction">Introduction</h4>
<p>In the <a href="/ParSim/dem/CFL-condition-discrete-elements/">first part</a> of this article,
we looked at the one-dimensional linear second-order wave equation
<!--more--></p>
<div>
$$
  \frac{\partial^2 u}{\partial t^2} - \frac{\partial^2 u}{\partial x^2} = 0 
$$
</div>
<p>We saw that for a discretization with grid size \(\Delta x\) and  timestep \(\Delta t\), a
central difference approximation is convergent if the CFL condition</p>
<div>
$$
  \frac{\Delta x}{\Delta t} &gt; 1
$$
</div>
<p>is satisfied.
The numerical method is also stable in this case because the PDE is linear.</p>

<p>Of course, in the above equation we have chosen the units of space and time such that the
wave speed is 1.  In general, it is more convenient to work with quantities for which the
wave speed is not 1, and the 1D wave equation has the form</p>
<div>
$$
  \frac{\partial^2 u}{\partial t^2} - c^2\frac{\partial^2 u}{\partial x^2} = 0 \,\quad
  c = \sqrt{\frac{K}{\rho}}
$$
</div>
<p>where, for linear elasticity, \(K\) is the bulk modulus and \(\rho\) is the mass-density.
In that case the CFL condition will be scaled accordingly by the wave speed.</p>

<p>Note that the above equation is equivalent to the following first-order wave equations:</p>
<div>
$$
  \frac{\partial u}{\partial t} - c\frac{\partial u}{\partial x} = 0 \,\quad
  \frac{\partial u}{\partial t} + c\frac{\partial u}{\partial x} = 0 
$$
</div>

<p>Linear PDEs with constant coefficients of this form have <strong>plane wave</strong> solutions:</p>
<div>
$$
  u(x, t) = \exp[i(\kappa x - \omega t)]
$$
</div>
<p>where \(\kappa\) is the (real) wave number and \(\omega\) is the (complex) frequency.  The
relation between the wave number and the frequency, \(\omega= \omega(\kappa )\),
is called a <strong>dispersion relation</strong>.</p>

<h4 id="the-von-neumann-approach-to-stability-analysis">The von Neumann approach to stability analysis</h4>
<p>A numerical algorithm for solving a PDE is said to be <strong>stable</strong> if the solution
at a given time does not blow up as the time step decreases, i.e., approximation errors
do not increase with time.</p>

<p>The von Neumann technique, proposed by John von Neumann in the 1950s expanding upon earlier
work by Crank and Nicolson, is the most popular approach for finding stability conditions
for <strong>linear PDEs with periodic boundary conditions</strong>.  No general approach is for stability
analysis is yet known for nonlinear PDEs.  However, for many practical nonlinear PDEs, the
linearized form is amenable to the same type of analysis.</p>

<p>The von Neumann approach uses the observation that linear PDEs admit plane wave solutions
to find a bound on numerical errors produced by explicit one-step finite differences.
Let us examine the technique in a bit more detail for the first-order wave equation
with forward differences.  We have</p>

<div>
$$
  \frac{u(x, t+\Delta t) - u(x,t)}{\Delta t}
  + c\,\frac{u(x+\Delta x, t) - u(x,t)}{\Delta x} = 0 
$$
</div>
<p>We can write the above as</p>
<div>
$$
  u_{i,j+1} - u_{i,j} + \frac{c \Delta t}{\Delta x} (u_{i+1,j} - u_{i,j}) = 0
$$
</div>
<p>or,</p>
<div>
$$
  u_{i,j+1} =  (1 + C) u_{i,j} - C u_{i+1,j} \quad \text{where} \quad
  C := \frac{c \Delta t}{\Delta x} 
$$
</div>
<p>Since the PDE admits plane wave solutions, let us examine what happens when we insert solutions
of that form into the discretized equation, i.e.,</p>
<div>
$$
  u(x_i, t_j) = e^{i(\kappa x_i - \omega t_j)} 
$$
</div>
<p>We then get</p>
<div>
$$
  u_{i,j+1} = (1 + C) e^{i(\kappa x_i - \omega t_j)}
              - Ce^{i(\kappa x_{i+1} - \omega t_j)} 
$$
</div>
<p>or</p>
<div>
$$
  \begin{align}
  u_{i,j+1} &amp; = (1 + C) e^{i(\kappa x_i - \omega t_j)}
              = Ce^{i(\kappa x_i - \omega t_j)} e^{i\kappa\Delta x} \\
            &amp; = (1 + C - Ce^{i\kappa\Delta x}) u_{i,j} 
  \end{align}
$$
</div>
<p>Therefore the expected numerical solution at \(x_i\) is of the form</p>
<div>
$$
  u_{j+1} = \mathcal{G}[u_{j}] 
$$
</div>
<p>However, due to cumulative numerical rounding errors, we get a sequence of solutions</p>
<div>
$$
  u_0 + \epsilon_0, u_1 + \epsilon_1, u_2 + \epsilon_2, \dots
$$
</div>
<p>and the actual numerical solution that we get is</p>
<div>
$$
  u_{j+1} + \epsilon_{j+1} = \mathcal{G}[u_j + \epsilon_j] 
$$
</div>
<p>If we assume that a Taylor series expansion of the function \(\mathcal{G}\) is possible,
we can make the first-order approximation</p>
<div>
$$
  u_{j+1} + \epsilon_{j+1} = \mathcal{G}[u_j] + \epsilon_j\,\frac{\partial\mathcal{G}}{\partial u_j}
    = u_{j+1} + G\,\epsilon^j \quad \implies \epsilon_{j+1} = G\,\epsilon_j 
$$
</div>
<p>The quantity \(G\) is called the <strong>amplification factor</strong>.  For the first-order wave equation
with forward differences, from the plane wave solution we have</p>
<div>
$$
  G = \frac{\partial\mathcal{G}}{\partial u_j}
    = \frac{\partial}{\partial u_j}\left[\left(1 + C - Ce^{i\kappa\Delta x}\right) u_{j}\right]  
    = 1 + C - Ce^{i\kappa\Delta x} 
$$
</div>
<p>Clearly, for the solution to be stable, the amplification factor must satisfy the requirement that</p>
<div class="notice--info">
$$
  |G| = \Bigl|\frac{\epsilon_{j+1}}{\epsilon_j}\Bigr| \le 1
$$
</div>
<p>which implies that errors do not grow in an unbounded manner with time.  For the first-order wave equation,</p>
<div>
$$
  \begin{align}
  |G|^2 &amp; = G\bar{G} = \left[1 + C(1-\cos\kappa\Delta x) - iC\sin\kappa\Delta x\right]
                     \left[1 + C(1-\cos\kappa\Delta x) + iC\sin\kappa\Delta x\right] \\
        &amp; = 1 + 2C(1+C)(1-\cos\kappa\Delta x) \le 1
  \end{align}
$$
</div>
<p>Since \(\kappa\Delta x\) is arbitrary, the above condition is satisfied only if</p>
<div>
$$
  2C(1+C) \le 0 \quad \implies \quad -1 \le C \le 0
   \equiv -1 \le \frac{c \Delta t}{\Delta x} \le 0
$$
</div>
<p>You can easily show that this is equivalent to the CFL condition for this particular
backward propagating one-dimensional wave propagation problem.</p>

<p>For the forward propagating second-order wave equation, the equivalent stability condition is,
(from both CFL analysis and the von Neumann analysis)</p>
<div class="notice--info">
$$
   0 \lt \frac{c \Delta t}{\Delta x} \le 1 \quad \equiv \quad
   \Delta t \le \frac{\Delta x}{c}
$$
</div>

<h4 id="remarks">Remarks</h4>
<p>The CFL procedure is inadequate for closed form stability bounds for many PDEs even though
convergence results can be obtained.  The von Neumann approach solves some of these issues
for linear PDEs.</p>

<p>We will see how these ideas are applied to discrete element methods in the next part of this
series.</p>


        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/ParSim/categories/#dem" class="page__taxonomy-item" rel="tag">DEM</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2017-04-14T22:30:00+12:00">April 14, 2017</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=The+CFL+condition+for+explicit+discrete+element+methods%3A2%20https%3A%2F%2Fbbanerjee.github.io%2FParSim%2Fdem%2FCFL-condition-discrete-elements-part-2%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fbbanerjee.github.io%2FParSim%2Fdem%2FCFL-condition-discrete-elements-part-2%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fbbanerjee.github.io%2FParSim%2Fdem%2FCFL-condition-discrete-elements-part-2%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/ParSim/dem/CFL-condition-discrete-elements/" class="pagination--pager" title="The CFL condition for explicit discrete element methods:1
">Previous</a>
    
    
      <a href="/ParSim/dem/CFL-condition-discrete-elements-part-3/" class="pagination--pager" title="The CFL condition for explicit discrete element methods:3
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ParSim/fem/meshing/gmsh/gmsh-meshing-for-code-aster/" rel="permalink">Meshes with different element topologies in gmsh (for Code-Aster)
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          39 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">We have been translating a few Code-Aster verification test manuals into English.
The process is not just a straightforward translation of the text in the Fr...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ParSim/fem/meshing/gmsh/quadrlateral-meshing-with-gmsh/" rel="permalink">Creating quadrilateral surface meshes with gmsh
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          21 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">The Code-Aster cooling tower modal analysis validation test
FORMA11c comes with a quadrilateral mesh provided by Code-Aster.
Tips on quadrilateral meshing wi...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ParSim/fem/cracks/python/salome-meca/code-aster/inspecting-and-manipulating-meshes/" rel="permalink">Inspecting and manipulating meshes in Salome-Meca for Code-Aster
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          30 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">In this article, I will discuss how elements can be selected from deep inside a 3D mesh
in the Salome-Meca environment and manipulated with Python scripts.

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ParSim/vaango/compiling-vaango-on-a-cray/" rel="permalink">Compiling and running the MPM code Vaango on a Cray
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          16 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Introduction

One of the reasons I switched to cmake for my builds was the need to compile my
Vaango code on a BlueGene/Q system.  The code was previously co...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
    

    <li><a href="/ParSim/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Biswajit Banerjee. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/ParSim/assets/js/main.min.js"></script>










  </body>
</html>
