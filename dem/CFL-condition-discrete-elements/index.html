<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.21.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>The CFL condition for explicit discrete element methods:1 - Parresia Simulations</title>
<meta name="description" content="Part 1: How to estimate a stable timestep size">


  <meta name="author" content="Biswajit Banerjee">
  
  <meta property="article:author" content="Biswajit Banerjee">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Parresia Simulations">
<meta property="og:title" content="The CFL condition for explicit discrete element methods:1">
<meta property="og:url" content="https://bbanerjee.github.io/ParSim/dem/CFL-condition-discrete-elements/">


  <meta property="og:description" content="Part 1: How to estimate a stable timestep size">







  <meta property="article:published_time" content="2017-04-11T22:30:00+12:00">





  

  


<link rel="canonical" href="https://bbanerjee.github.io/ParSim/dem/CFL-condition-discrete-elements/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Biswajit Banerjee",
      "url": "https://bbanerjee.github.io/ParSim/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/ParSim/feed.xml" type="application/atom+xml" rel="alternate" title="Parresia Simulations Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/ParSim/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<link rel="stylesheet" href="https://bbanerjee.github.io/ParSim/assets/css/parresia.css">

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <script type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_HTMLorMML">
  </script>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/ParSim/"><img src="/ParSim/assets/img/ParresiaLogoSep2017_plain.png" alt=""></a>
        
        <a class="site-title" href="/ParSim/">
          Parresia Simulations
          <span class="site-subtitle">Parallel particle and finite element simulation</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/ParSim/docs/articles/">Blog articles</a>
            </li><li class="masthead__menu-item">
              <a href="/ParSim/docs/parsim/">ParSim software</a>
            </li><li class="masthead__menu-item">
              <a href="/ParSim/docs/material-data/">Material data</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Biswajit Banerjee</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>PhD Mechanical Engineering</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Auckland, NZ</span>
        </li>
      

      
        
          
            <li><a href="mailto:b.banerjee.nz@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="The CFL condition for explicit discrete element methods:1">
    <meta itemprop="description" content="IntroductionSolutions of hyperbolic partial differential equations using explicit numerical methodsneed a means of limiting the timestep so that the solution is stable.  A criterion that is usually used to constrain the step size is the Courant–Friedrichs–Lewy condition.">
    <meta itemprop="datePublished" content="2017-04-11T22:30:00+12:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">The CFL condition for explicit discrete element methods:1
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          11 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> Contents</h4></header>
              <ul class="toc__menu">
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#the-cfl-condition">The CFL condition</a></li>
  <li><a href="#remarks">Remarks</a></li>
</ul>

            </nav>
          </aside>
        
        <link rel="stylesheet" type="text/css" href="/ParSim/assets/js/animateCFL.css" />

<h4 id="introduction">Introduction</h4>
<p>Solutions of hyperbolic partial differential equations using explicit numerical methods
need a means of limiting the timestep so that the solution is stable.  A criterion 
that is usually used to constrain the step size is the 
<a href="https://en.wikipedia.org/wiki/Courant%E2%80%93Friedrichs%E2%80%93Lewy_condition">Courant–Friedrichs–Lewy condition</a>.
<!--more--></p>

<p>Let us first explore what the 1928 paper by the Courant, Friedrichs, and Lewy had to say on
stability.  I will then examine the von Neumann form of the condition that is widely used
in forward difference calculations.  Finally, I will say something about the application of these
ideas to discrete element methods.  Depending on my patience, I’ll probably break up the article
into two or three parts.</p>

<h4 id="the-cfl-condition">The CFL condition</h4>
<p>The easiest starting point for the analysis is the one-dimensional wave equation:</p>
<div>
$$
  \frac{\partial^2 u}{\partial t^2} - \frac{\partial^2 u}{\partial x^2} = 0 \,.
$$
</div>
<p>Let us assume that the value of the solution \(u(x,t)\) and its derivatives are known
at time \(t = 0\).</p>

<p>If we use a grid size \(\Delta x\) and a timestep \(\Delta t\), the derivatives can be expressed as</p>
<div>
$$
 \begin{align}
  \frac{\partial^2 u}{\partial x^2} \approx u_{xx} &amp; =
    \frac{1}{\Delta x^2}[u(x+\Delta x, t) - 2u(x, t) + u(x-\Delta x, t)] \\
  \frac{\partial^2 u}{\partial t^2} \approx u_{tt} &amp; =
    \frac{1}{\Delta t^2}[u(x, t+\Delta t) - 2u(x, t) + u(x, t-\Delta t)] \,.
 \end{align}
$$
</div>

<p>Consider the case where \(\Delta t = h\) and \(\Delta x = kh\). In
that case, the 1D wave equation can be discretized as</p>
<div>
$$
  u(x, t+h) + u(x, t-h) - u(x+kh, t) + u(x-kh, t) = 0  \,.
$$
</div>

<p>This implies that each point \(x\) has an evolving region of influence that grows
as shown (for \(k=1\)) in the animation below, i.e., the value at that point has an immediate effect only on
points in the region of influence (also called <strong>domain of dependence</strong>).</p>

<div class="cfl-wave-animation">
</div>

<p>Similarly, there is a <strong>mathematical domain of dependence</strong> of the underlying hyperbolic
PDE that is exact.  What the CFL paper found was that</p>

<blockquote>
  <p>The domain of dependence for the difference equation for this mesh will now either lie entirely within
the domain of dependence of the differential equation, or on the other hand will contain this latter
region inside its own domain according as k &lt; 1 or k &gt; 1 respectively</p>
</blockquote>

<p>This finding implies that if k &lt; 1, the domain of dependence (DoD) of the discrete equation is inside
the DoD of the original PDE.  You can see that in the animation below (use the slider to
change the value of \(k\) to 0.5).  In the animation we have kept \(h = \Delta t\) constant and the
green lines are a proxy for the mathematical domain of dependence.</p>

<div class="cfl-domain-animation">
</div>

<p>If we decrease \(h\), and keep k &lt; 1, the domain of dependence of the discrete equation
becomes smaller relative to the mathematical (exact) domain!  Therefore the discrete solution 
will not converge to the exact solution if k &lt; 1, however small we choose the value of \(h\) to be.</p>

<p>The CFL paper also proved that convergence is indeed achieved for \(k &gt; 1\),
or, in this case,</p>
<div>
$$
  \frac{\Delta x}{\Delta t} &gt; 1\,.
$$
</div>

<p>The same observation is true for many different types or linear and nonlinear PDEs.  With that
is mind, We can write the CFL condition as described in the Courant-Friedrich-Lewy paper as follows.</p>

<p class="notice--info"><strong>The CFL Condition</strong>  For each point in the domain of a PDE, the CFL condition is
satisfied if the mathematical domain of dependence is contained in the
numerical domain of dependence.</p>

<p class="notice--info"><strong>The CFL Theorem</strong> The CFL condition is a necessary condition for the <strong>convergence</strong> of a
numerical approximation of a PDE.
The <a href="https://en.wikipedia.org/wiki/Lax_equivalence_theorem">Lax Equivalence Theorem</a>
then implies that the
CFL condition is also a necessary condition for the <strong>stability</strong> of the numerical scheme if the PDE is linear.</p>

<h4 id="remarks">Remarks</h4>
<p>While this is a powerful general result, the constraint is not tight enough for practical 
calculations.  The von Neumann result that will be discussed in the next part of this series
will show how we can come up with a easier way of computing stability conditions for linear PDEs.</p>

<p>The animations are a bit buggy at this point but will do for the purposes of this article.</p>

<script src="/ParSim/assets/js/d3.v4.min.js"></script>

<script src="/ParSim/assets/js/animateWave.js"></script>

<script src="/ParSim/assets/js/animateCFL.js"></script>


        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/ParSim/categories/#dem" class="page__taxonomy-item" rel="tag">DEM</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2017-04-11T22:30:00+12:00">April 11, 2017</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=The+CFL+condition+for+explicit+discrete+element+methods%3A1%20https%3A%2F%2Fbbanerjee.github.io%2FParSim%2Fdem%2FCFL-condition-discrete-elements%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fbbanerjee.github.io%2FParSim%2Fdem%2FCFL-condition-discrete-elements%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fbbanerjee.github.io%2FParSim%2Fdem%2FCFL-condition-discrete-elements%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/ParSim/c++/xml/gzip/reading-xml-with-gzipped-data/" class="pagination--pager" title="Reading XML files containing gzipped data in C++
">Previous</a>
    
    
      <a href="/ParSim/dem/CFL-condition-discrete-elements-part-2/" class="pagination--pager" title="The CFL condition for explicit discrete element methods:2
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ParSim/fem/meshing/gmsh/gmsh-meshing-for-code-aster/" rel="permalink">Meshes with different element topologies in gmsh (for Code-Aster)
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          39 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">We have been translating a few Code-Aster verification test manuals into English.
The process is not just a straightforward translation of the text in the Fr...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ParSim/fem/meshing/gmsh/quadrlateral-meshing-with-gmsh/" rel="permalink">Creating quadrilateral surface meshes with gmsh
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          21 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">The Code-Aster cooling tower modal analysis validation test
FORMA11c comes with a quadrilateral mesh provided by Code-Aster.
Tips on quadrilateral meshing wi...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ParSim/fem/cracks/python/salome-meca/code-aster/inspecting-and-manipulating-meshes/" rel="permalink">Inspecting and manipulating meshes in Salome-Meca for Code-Aster
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          30 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">In this article, I will discuss how elements can be selected from deep inside a 3D mesh
in the Salome-Meca environment and manipulated with Python scripts.

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ParSim/vaango/compiling-vaango-on-a-cray/" rel="permalink">Compiling and running the MPM code Vaango on a Cray
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          16 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Introduction

One of the reasons I switched to cmake for my builds was the need to compile my
Vaango code on a BlueGene/Q system.  The code was previously co...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
    

    <li><a href="/ParSim/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Biswajit Banerjee. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/ParSim/assets/js/main.min.js"></script>










  </body>
</html>
